# Secret Scan CI Workflow
# Epic 36: Block PRs with leaked secrets

name: Secret Scan

on:
    pull_request:
    push:
        branches: [main, develop]

jobs:
    gitleaks:
        name: Gitleaks Secret Scan
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v4
              with:
                  fetch-depth: 0

            - name: Run Gitleaks
              uses: gitleaks/gitleaks-action@v2
              env:
                  GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

            - name: Secret Scan Result
              if: failure()
              run: |
                  echo "‚ùå SECRETS DETECTED - PR blocked"
                  echo "Remove secrets before merging"
                  exit 1
